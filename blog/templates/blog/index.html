<script type="text/javascript">

function vote(slug, direction, id) {
  $.post(slug + '/vote/' + direction, {HTTP_X_REQUESTED:'XMLHttpRequest'},
      function(data){
        if(direction == 'up'){
          $('#votes-button-' + id).toggleClass('btn-default btn-primary');
        }
        else{
          $('#votes-button-' + id).toggleClass('btn-primary btn-default');
        }
        $('#votes-' + id).text(data);
      }
    )
  }
</script>


{% extends "blog/base.html" %}
{% load staticfiles %}
{% load humanize %}
{% block content %}
<div class="col-md-offset-1 col-md-7">
{% regroup posts_list by created_at|date as regrouped_posts_list %}
{% for post in regrouped_posts_list %}
    <h5>{{ post.grouper|naturalday }}</h5>
    <ul class="list-group media-list media-list-stream">
    {% for item in post.list %}
      {% if item.approved == 1 %}
          <li class="media list-group-item p-a">
            <a class="media-left" href="{% url 'detail' item.slug %}">
              <div class="thumbnail-custom">
                <div style="
                        background: url('{{item.image_file.url}}');
                        background-size:cover;
                        background-position:center;
                        ">
                </div>
              </div>
            </a>
            <div class="media-body">
              <div class="media-heading">
                <small class="pull-right text-muted hidden-xs"><i class="fa fa-clock-o text-primary"></i> {{item.created_at|date:"M d, Y"}}</small>
                <a href="{% url 'detail' item.slug %}" class="no-text-decoration"><h4>{{item.title}}</h4></a>
                <h5>{{item.slogan}}</h5>
                <div class="media">
                  <div class="media-body hidden-xs">
                    {% if item.slug in votes_list %}
                      <button id="votes-button-{{item.id}}" onclick="vote('{{ item.slug }}', 'down', {{ item.id }});" type="button" class="btn btn-xs btn-primary"><i class="fa fa-arrow-up"></i><span id="votes-{{item.id}}"> {{item.votes}}</span></button>
                    {% else %}
                      <button id="votes-button-{{item.id}}" onclick="vote('{{ item.slug }}', 'up', {{ item.id }});" type="button" class="btn btn-xs btn-default"><i class="fa fa-arrow-up"></i><span id="votes-{{item.id}}"> {{item.votes}}</span></button>
                    {% endif %}

                    <a href="{{item.link}}?ref=earlist" target="_blank" type="button" class="btn btn-xs btn-default" style="padding:4 4 4 4"><i class="fa fa-external-link"></i></a>
                    
                  </div>
                  <!--<a class="media-left" href="#">
                    <img class="media-object img-circle" style="width:25px;"src="https://pbs.twimg.com/profile_images/423161155104681985/9mYQOnT2_400x400.jpeg">
                  </a>
                  <div class="media-body">
                    <small>@priverass</small>
                  </div>-->
                </div>
              </div>
              <div class="row">
                <div class="col-sm-8">
                  {# <p>{{post.body}}</p> #}
                </div>
                <div class="col-sm-4 text-right">
                  {# <button type="button" class="btn btn-primary-outline pull w-full">Ir al sitio</button> #}
                  {# <button type="button" class="btn btn-primary-outline pull w-full">Guardar</button> #}
                </div>
              </div>
              {# <button type="button" class="pull-right btn btn-xs btn-pill btn-primary">{{post.category}}</button> #}
            </div>
          </li>
      {% endif %}
    {% endfor %}
    </ul>
{% endfor %}
</div>
{% include 'blog/right-col.html' %}
{% endblock %}
